import{q as L,r as j,P as D,f as H,k as M,n as P,m as $,o as V,j as S,h as _,t as k,A as B,v as Q}from"./main-C5yPUGWL.js";var R={},z=c=>encodeURIComponent(c).replace(/[!'()*]/g,i=>`%${i.charCodeAt(0).toString(16).toUpperCase()}`),q="%[a-f0-9]{2}",I=new RegExp("("+q+")|([^%]+?)","gi"),U=new RegExp("("+q+")+","gi");function N(c,i){try{return[decodeURIComponent(c.join(""))]}catch{}if(c.length===1)return c;i=i||1;var f=c.slice(0,i),u=c.slice(i);return Array.prototype.concat.call([],N(f),N(u))}function G(c){try{return decodeURIComponent(c)}catch{for(var i=c.match(I)||[],f=1;f<i.length;f++)c=N(i,f).join(""),i=c.match(I)||[];return c}}function K(c){for(var i={"%FE%FF":"��","%FF%FE":"��"},f=U.exec(c);f;){try{i[f[0]]=decodeURIComponent(f[0])}catch{var u=G(f[0]);u!==f[0]&&(i[f[0]]=u)}f=U.exec(c)}i["%C2"]="�";for(var y=Object.keys(i),g=0;g<y.length;g++){var m=y[g];c=c.replace(new RegExp(m,"g"),i[m])}return c}var J=function(c){if(typeof c!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof c+"`");try{return c=c.replace(/\+/g," "),decodeURIComponent(c)}catch{return K(c)}},W=(c,i)=>{if(!(typeof c=="string"&&typeof i=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(i==="")return[c];const f=c.indexOf(i);return f===-1?[c]:[c.slice(0,f),c.slice(f+i.length)]},X=function(c,i){for(var f={},u=Object.keys(c),y=Array.isArray(i),g=0;g<u.length;g++){var m=u[g],F=c[m];(y?i.indexOf(m)!==-1:i(m,F,c))&&(f[m]=F)}return f};(function(c){const i=z,f=J,u=W,y=X,g=r=>r==null,m=Symbol("encodeFragmentIdentifier");function F(r){switch(r.arrayFormat){case"index":return e=>(t,n)=>{const a=t.length;return n===void 0||r.skipNull&&n===null||r.skipEmptyString&&n===""?t:n===null?[...t,[o(e,r),"[",a,"]"].join("")]:[...t,[o(e,r),"[",o(a,r),"]=",o(n,r)].join("")]};case"bracket":return e=>(t,n)=>n===void 0||r.skipNull&&n===null||r.skipEmptyString&&n===""?t:n===null?[...t,[o(e,r),"[]"].join("")]:[...t,[o(e,r),"[]=",o(n,r)].join("")];case"colon-list-separator":return e=>(t,n)=>n===void 0||r.skipNull&&n===null||r.skipEmptyString&&n===""?t:n===null?[...t,[o(e,r),":list="].join("")]:[...t,[o(e,r),":list=",o(n,r)].join("")];case"comma":case"separator":case"bracket-separator":{const e=r.arrayFormat==="bracket-separator"?"[]=":"=";return t=>(n,a)=>a===void 0||r.skipNull&&a===null||r.skipEmptyString&&a===""?n:(a=a===null?"":a,n.length===0?[[o(t,r),e,o(a,r)].join("")]:[[n,o(a,r)].join(r.arrayFormatSeparator)])}default:return e=>(t,n)=>n===void 0||r.skipNull&&n===null||r.skipEmptyString&&n===""?t:n===null?[...t,o(e,r)]:[...t,[o(e,r),"=",o(n,r)].join("")]}}function b(r){let e;switch(r.arrayFormat){case"index":return(t,n,a)=>{if(e=/\[(\d*)\]$/.exec(t),t=t.replace(/\[\d*\]$/,""),!e){a[t]=n;return}a[t]===void 0&&(a[t]={}),a[t][e[1]]=n};case"bracket":return(t,n,a)=>{if(e=/(\[\])$/.exec(t),t=t.replace(/\[\]$/,""),!e){a[t]=n;return}if(a[t]===void 0){a[t]=[n];return}a[t]=[].concat(a[t],n)};case"colon-list-separator":return(t,n,a)=>{if(e=/(:list)$/.exec(t),t=t.replace(/:list$/,""),!e){a[t]=n;return}if(a[t]===void 0){a[t]=[n];return}a[t]=[].concat(a[t],n)};case"comma":case"separator":return(t,n,a)=>{const d=typeof n=="string"&&n.includes(r.arrayFormatSeparator),s=typeof n=="string"&&!d&&l(n,r).includes(r.arrayFormatSeparator);n=s?l(n,r):n;const h=d||s?n.split(r.arrayFormatSeparator).map(T=>l(T,r)):n===null?n:l(n,r);a[t]=h};case"bracket-separator":return(t,n,a)=>{const d=/(\[\])$/.test(t);if(t=t.replace(/\[\]$/,""),!d){a[t]=n&&l(n,r);return}const s=n===null?[]:n.split(r.arrayFormatSeparator).map(h=>l(h,r));if(a[t]===void 0){a[t]=s;return}a[t]=[].concat(a[t],s)};default:return(t,n,a)=>{if(a[t]===void 0){a[t]=n;return}a[t]=[].concat(a[t],n)}}}function C(r){if(typeof r!="string"||r.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function o(r,e){return e.encode?e.strict?i(r):encodeURIComponent(r):r}function l(r,e){return e.decode?f(r):r}function x(r){return Array.isArray(r)?r.sort():typeof r=="object"?x(Object.keys(r)).sort((e,t)=>Number(e)-Number(t)).map(e=>r[e]):r}function E(r){const e=r.indexOf("#");return e!==-1&&(r=r.slice(0,e)),r}function w(r){let e="";const t=r.indexOf("#");return t!==-1&&(e=r.slice(t)),e}function p(r){r=E(r);const e=r.indexOf("?");return e===-1?"":r.slice(e+1)}function O(r,e){return e.parseNumbers&&!Number.isNaN(Number(r))&&typeof r=="string"&&r.trim()!==""?r=Number(r):e.parseBooleans&&r!==null&&(r.toLowerCase()==="true"||r.toLowerCase()==="false")&&(r=r.toLowerCase()==="true"),r}function A(r,e){e=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},e),C(e.arrayFormatSeparator);const t=b(e),n=Object.create(null);if(typeof r!="string"||(r=r.trim().replace(/^[?#&]/,""),!r))return n;for(const a of r.split("&")){if(a==="")continue;let[d,s]=u(e.decode?a.replace(/\+/g," "):a,"=");s=s===void 0?null:["comma","separator","bracket-separator"].includes(e.arrayFormat)?s:l(s,e),t(l(d,e),s,n)}for(const a of Object.keys(n)){const d=n[a];if(typeof d=="object"&&d!==null)for(const s of Object.keys(d))d[s]=O(d[s],e);else n[a]=O(d,e)}return e.sort===!1?n:(e.sort===!0?Object.keys(n).sort():Object.keys(n).sort(e.sort)).reduce((a,d)=>{const s=n[d];return s&&typeof s=="object"&&!Array.isArray(s)?a[d]=x(s):a[d]=s,a},Object.create(null))}c.extract=p,c.parse=A,c.stringify=(r,e)=>{if(!r)return"";e=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},e),C(e.arrayFormatSeparator);const t=s=>e.skipNull&&g(r[s])||e.skipEmptyString&&r[s]==="",n=F(e),a={};for(const s of Object.keys(r))t(s)||(a[s]=r[s]);const d=Object.keys(a);return e.sort!==!1&&d.sort(e.sort),d.map(s=>{const h=r[s];return h===void 0?"":h===null?o(s,e):Array.isArray(h)?h.length===0&&e.arrayFormat==="bracket-separator"?o(s,e)+"[]":h.reduce(n(s),[]).join("&"):o(s,e)+"="+o(h,e)}).filter(s=>s.length>0).join("&")},c.parseUrl=(r,e)=>{e=Object.assign({decode:!0},e);const[t,n]=u(r,"#");return Object.assign({url:t.split("?")[0]||"",query:A(p(r),e)},e&&e.parseFragmentIdentifier&&n?{fragmentIdentifier:l(n,e)}:{})},c.stringifyUrl=(r,e)=>{e=Object.assign({encode:!0,strict:!0,[m]:!0},e);const t=E(r.url).split("?")[0]||"",n=c.extract(r.url),a=c.parse(n,{sort:!1}),d=Object.assign(a,r.query);let s=c.stringify(d,e);s&&(s=`?${s}`);let h=w(r.url);return r.fragmentIdentifier&&(h=`#${e[m]?o(r.fragmentIdentifier,e):r.fragmentIdentifier}`),`${t}${s}${h}`},c.pick=(r,e,t)=>{t=Object.assign({parseFragmentIdentifier:!0,[m]:!1},t);const{url:n,query:a,fragmentIdentifier:d}=c.parseUrl(r,t);return c.stringifyUrl({url:n,query:y(a,e),fragmentIdentifier:d},t)},c.exclude=(r,e,t)=>{const n=Array.isArray(e)?a=>!e.includes(a):(a,d)=>!e(a,d);return c.pick(r,n,t)}})(R);const Y=L(R),Z=(c,i)=>{const[f,u]=j.useState("");return j.useEffect(()=>{const y=setTimeout(()=>u(c),i);return()=>clearTimeout(y)},[i,c]),f},v=({isAuthenticated:c})=>{const i=H(),[f,u]=j.useState(""),[y,g]=j.useState([]),[m,F]=j.useState(!1),b=j.useRef(null),C=M(),o=P();let l;i&&(l=$());const x=Z(f,500),{data:E,isLoading:w,error:p}=V(x);j.useEffect(()=>{const t=Y.parse(o.search).q||"";u(t),i&&(l=$()),l&&g(l)},[o.search]);const O=()=>{if(f.trim()){if(c===B.AUTH){const e=[...y,f];g(e),Q(e)}C(`/Check-it/search/search?q=${encodeURIComponent(f)}`),u("")}};j.useEffect(()=>{const e=t=>{b.current&&b.current.contains(t.target)?F(!0):F(!1)};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},[]);const A=e=>{u(e.target.value)},r=()=>{F(!0)};return S.jsxs("form",{className:"user-block",ref:b,children:[S.jsx("input",{type:"text",value:f,onChange:e=>{A(e)},onKeyDown:e=>{e.key==="Enter"&&O()},onFocus:r,placeholder:"Название фильма..."}),S.jsx("button",{className:"search__button",onClick:O,children:"Поиск"}),S.jsx("div",{className:"search-movie-card-list  ",children:E?E.films.map(e=>{const t=e.filmId||e.kinopoiskId;return S.jsx(_,{className:`search-movie-card ${m?"":"hidden"}`,to:`${k.ROOT}films/${t}`,children:S.jsxs("div",{className:"search-movie-card__image",children:[S.jsx("img",{src:e.posterUrlPreview,alt:e.nameRu||e.nameEn||"Без названия"}),S.jsx("span",{children:e.nameRu||e.nameEn||"Без названия"})]})},t)}):""})]})};v.propTypes={isAuthenticated:D.string.isRequired};export{v as S,Y as q};
