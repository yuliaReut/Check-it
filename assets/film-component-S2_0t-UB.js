import{j as e,R as h,r as m,c as C,T as k,a as y,u,d as w,g as j,A as _,e as b,s as D,f as L,h as O,L as E,P as H,l as P,b as R}from"./main-DllzQGCZ.js";import{F as v}from"./film.prop-BkqpvgzV.js";import{a as U,F as M}from"./films-list-component-CAkXS_jw.js";import{F as I}from"./logo-component-C42aMshr.js";import{H as K}from"./header-component-BVxeEosf.js";import{a as $,g as z}from"./selectors-CiXzrJxP.js";import"./search-component-BDAefVUj.js";const g=o=>{const{film:i}=o,{ratingKinopoisk:a,ratingKinopoiskVoteCount:r,nameOriginal:t,genres:s,description:c}=i;return e.jsxs(h.Fragment,{children:[e.jsxs("div",{className:"movie-rating",children:[e.jsx("div",{className:"movie-rating__score",children:a}),e.jsxs("p",{className:"movie-rating__meta",children:[e.jsx("span",{className:"movie-rating__level",children:Number(a)>8?"Very good":"Bad"}),e.jsxs("span",{className:"movie-rating__count",children:[r," оценили"]})]})]}),e.jsxs("div",{className:"movie-card__text",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Описание фильма: "}),c]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Оригинальное название: "}),t]}),e.jsxs("p",{className:"movie-card__starring",children:[e.jsx("strong",{children:" Жанры: "}),s.map(d=>e.jsx("span",{className:"movie-rating__count",children:d.genre},a+d.genre))]})]})]})};g.propTypes={film:v};const N=o=>{const{film:i}=o,{ratingKinopoisk:a,filmLength:r,year:t,countries:s}=i;return e.jsx("div",{className:"movie-card__text movie-card__row",children:e.jsxs("div",{className:"movie-card__text-col",children:[e.jsxs("p",{className:"movie-card__details-item",children:[e.jsx("strong",{className:"movie-card__details-name",children:"Продолжительность"}),e.jsx("span",{className:"movie-card__details-value",children:r})]}),e.jsxs("p",{className:"movie-card__details-item",children:[e.jsx("strong",{className:"movie-card__details-name",children:"Страны:"}),s.map(c=>e.jsx("span",{className:"movie-card__details-value",children:c.country},a+c.country))]}),e.jsxs("p",{className:"movie-card__details-item",children:[e.jsx("strong",{className:"movie-card__details-name",children:"Дата выпуска"}),e.jsx("span",{className:"movie-card__details-value",children:t})]})]})})};N.propTypes={film:v};const f=o=>{const{film:i}=o,[a,r]=m.useState("overview"),t=(s,c)=>{s.preventDefault(),r(c)};return e.jsxs(h.Fragment,{children:[e.jsx("nav",{className:"movie-nav movie-card__nav",children:e.jsxs("ul",{className:"movie-nav__list",children:[e.jsx("li",{className:`movie-nav__item ${a==="overview"?"movie-nav__item--active":""}`,children:e.jsx("a",{href:"#",className:"movie-nav__link",onClick:s=>t(s,"overview"),children:"Overview"})}),e.jsx("li",{className:`movie-nav__item ${a==="details"?"movie-nav__item--active":""}`,children:e.jsx("a",{href:"#",className:"movie-nav__link",onClick:s=>t(s,"details"),children:"Details"})})]})}),a==="overview"&&e.jsx(g,{film:i}),a==="details"&&e.jsx(N,{film:i})]})};f.propTypes={film:v};const B=({films:o})=>{const i=Number(C().id),{isDarkTheme:a}=m.useContext(k),r=y(),t=u($),s=u(z),[c,d]=m.useState(t.includes(i)),{data:n,error:x,isLoading:F}=w(i);let p;if(j()===_.AUTH&&(p=b()),m.useEffect(()=>{const l=j();r(D(l||_.NO_AUTH)),L(l)},[r]),m.useEffect(()=>{O(p),d(t.includes(i))},[c,t]),F)return e.jsx(E,{});if(x)return e.jsxs("div",{children:["Ошибка: ",x.toString()]});const A=()=>{r(P()),R()};return e.jsxs(h.Fragment,{children:[e.jsxs("section",{className:"movie-card movie-card--full",children:[e.jsxs("div",{className:"movie-card__hero",children:[e.jsx("div",{className:"movie-card__bg",children:e.jsx("img",{src:n.posterUrl,alt:n.nameOriginal})}),e.jsx("h1",{className:"visually-hidden",children:"Check it"}),e.jsx(K,{onExit:A,isAuthenticated:s}),e.jsx("div",{className:"movie-card__wrap",children:e.jsxs("div",{className:"movie-card__desc",children:[e.jsx("h2",{className:"movie-card__title",children:n.nameRu}),e.jsx("p",{className:"movie-card__meta",children:e.jsxs("span",{className:"movie-card__year",children:[" ",n.year]})}),e.jsx("div",{className:"movie-card__buttons",children:s===_.AUTH?e.jsx(U,{filmId:i}):""})]})})]}),e.jsx("div",{className:"movie-card__wrap movie-card__translate-top",children:e.jsxs("div",{className:"movie-card__info",children:[e.jsx("div",{className:"movie-card__poster movie-card__poster--big",children:e.jsx("img",{src:n.posterUrlPreview,alt:n.nameRu,width:"218",height:"327"})}),e.jsx("div",{className:"movie-card__desc",children:e.jsx(f,{film:n})})]})})]}),e.jsxs("div",{className:`page-content page-content-${a?"dark":"light"}`,children:[e.jsxs("section",{className:"catalog catalog--like-this",children:[e.jsx("h2",{className:"catalog__title",children:"More like this"}),e.jsx("div",{className:"catalog__movies-list",children:e.jsx(M,{isAuthenticated:s,films:o.slice().filter(l=>l.genres.some(S=>n.genres.some(T=>T.genre===S.genre))).slice(0,4),maxFilms:4})})]}),e.jsx(I,{})]})]})};B.propTypes={films:H.arrayOf(v)};export{B as default};
